{
  "name": "Stage change on Case or Alert linked to CrowdStrike",
  "description": "Triggers when the stage changes on a Case or Alert that has a linked CrowdStrike Falcon alert or incident",
  "type": "filteredEvent",
  "status": "tested",
  "comment": "If customfield exists but has empty values, no notification is triggered. As a result, this notification will only trigger when the values are not empty for the custom fields (and not just 'existing' in the UI).",
  "filter": {
    "_and": [
      {
        "_is": {
          "action": "update"
        }
      },
      {
        "_or": [
          {
            "_is": {
              "objectType": "Alert"
            }
          },
          {
            "_is": {
              "objectType": "Case"
            }
          }
        ]
      },
      {
        "_contains": {
          "details.stage": ""
        }
      },
      {
        "_or": [
          {
            "_contains": {
              "context.customFieldValues.csfalcon-alert-id": ""
            }
          },
          {
            "_contains": {
              "context.customFieldValues.csfalcon-incident-id": ""
            }
          }
        ]
      }
    ]
  }
}
